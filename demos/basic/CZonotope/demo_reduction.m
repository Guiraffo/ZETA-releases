demoID = 'CZ complexity reduction';
util.demoinit;

%%

c = [1.6348; -0.8899];

G = [0.2096,  0.5830, -0.3575,  0,  0,  0,  0,  0, -0.0053, -0.0162, -0.0006,  0,  0,  0,  0,  0, -0.0390,   0.0146,   0.0195,   0, 0, 0, zeros(1,22),  0.0187,       0,  0;
    -0.1452, -0.1296, -0.0473,  0,  0,  0,  0,  0,  0.0033,  0.0080, -0.0008,  0,  0,  0,  0,  0,  0.0223,  -0.0072,  -0.0056,   0, 0, 0, zeros(1,22),       0,  0.0140,  0];

A = [0.2333,    0.4184,   -0.1500,    0.6000,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,    0.2000,    0.3000,   -0.1000,    0.3000,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
     0.1167,    0.2790,   -0.1500,         0,   -0.1000,   -0.2000,    0.1000,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
     0.1167,    0.1395,         0,         0,   -0.1000,   -0.1000,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0272,    0.0875,    0.0113,   0.1800,         0,         0,         0,         0,    0.1953,   -0.0700,   -0.1255,    0.2800,    0.5021,   -0.1800,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,   0.0467,    0.0837,   -0.0300,    0.1200,    0.0700,    0.1255,   -0.0450,    0.1800,         0,   -0.0233,   -0.0418,   0.0150,   -0.0600,         0,         0,    0.0700,    0.1255,   -0.0450,    0.1800,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,    0.0200,    0.0450,    0.0050,    0.0450,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,    0.1200,         0,         0,        0,         0,   -0.0400,   -0.0600,         0,         0,         0,         0,    0.1200,    0.1800,   -0.0600,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0136,    0.0584,    0.0113,        0,         0,         0,         0,         0,    0.1139,   -0.0525,   -0.1046,    0.0700,    0.1674,   -0.0900,  -0.0233,   -0.0418,    0.0150,   -0.0600,   -0.0467,   -0.0837,    0.0300,   -0.1200,         0,    0.0233,    0.0418,  -0.0150,    0.0600,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,   -0.0100,   -0.0300,   -0.0050,         0,         0,         0,         0,         0,         0,         0,   0.0233,    0.0558,   -0.0300,         0,    0.0350,    0.0837,   -0.0450,         0,   -0.0700,   -0.0117,   -0.0279,   0.0150,         0,    0.0300,    0.0500,    0.0350,    0.0837,   -0.0450,         0,   -0.0300,   -0.0600,    0.0300,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0068,    0.0389,    0.0113,        0,    0.0050,    0.0200,    0.0050,         0,    0.0651,   -0.0350,   -0.0837,         0,         0,         0,  -0.0233,   -0.0558,    0.0300,         0,   -0.0467,   -0.1116,    0.0600,         0,    0.0400,    0.0233,    0.0558,  -0.0300,         0,   -0.0200,   -0.0400,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0136,    0.0292,         0,        0,         0,         0,         0,         0,    0.0814,   -0.0175,   -0.0209,    0.0700,    0.0837,         0,  -0.0233,   -0.0418,    0.0150,   -0.0600,   -0.0233,   -0.0418,    0.0150,   -0.0600,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,   -0.0100,   -0.0150,         0,         0,         0,         0,         0,         0,         0,         0,   0.0233,    0.0279,         0,         0,    0.0350,    0.0418,         0,         0,   -0.0500,   -0.0117,   -0.0139,        0,         0,    0.0100,    0.0100,    0.0350,    0.0418,         0,         0,   -0.0300,   -0.0300,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0068,    0.0195,         0,        0,    0.0050,    0.0100,         0,         0,    0.0488,   -0.0175,   -0.0209,         0,         0,         0,  -0.0233,   -0.0418,    0.0150,         0,   -0.0350,   -0.0558,    0.0150,         0,    0.0300,    0.0117,    0.0139,        0,         0,   -0.0100,   -0.0100,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
          0,         0,         0,         0,         0,         0,         0,         0,    0.0068,    0.0097,         0,        0,    0.0050,    0.0050,         0,         0,    0.0325,         0,         0,         0,         0,         0,  -0.0233,   -0.0279,         0,         0,   -0.0233,   -0.0279,         0,         0,    0.0200,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0;
     0.0644,    0.4533,   -0.4048,         0,         0,         0,         0,         0,   -0.0021,   -0.0082,   -0.0013,        0,         0,         0,         0,         0,   -0.0167,    0.0074,    0.0138,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,    0.0187,    0.0140,    0.3000];
 
b = [0.0982;    0.3631;   -0.1877;   -0.0772;   -0.2964;    0.0357;    0.0169;   -0.1017;   -0.0232;   -0.0517;   -0.0504;  -0.0030;   -0.0268;   -0.0206;   -0.0959];


Z = CZonotope(c, G, A, b);

Zred = reduction(Z,4,2);

figure
hold on;
plot(Zred,'blue',1);
plot(Z,'green',1);
xlabel('x_1');
ylabel('x_2');
legend('Reduced','Original')
box on;
grid off;
